<!doctype html><html lang="en" class="light-style layout-menu-fixed" dir="ltr" data-theme="theme-default" data-assets-path="./../../assets/" data-template="horizontal-menu-template-starter"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,minimum-scale=1,maximum-scale=1"/><title>AARO Dashboard</title><meta name="description" content/><link rel="icon" type="image/x-icon" href="assets/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/><link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons@latest/iconfont/tabler-icons.min.css"><link rel="stylesheet" href="7f96fb030c3b8da277af.css"/><link rel="stylesheet" href="6c6375d92a7a8e50d101.css"/><link rel="stylesheet" href="d09b291222150a296b0e.css"/><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"><link rel="stylesheet" href="e195e574a2c8fdc8e6ef.css" rel="stylesheet"/><link rel="stylesheet" href="691a3d4d9e36bb1c97aa.css" rel="stylesheet"/><link rel="stylesheet" href="79649f0755bbbd692ca3.css" rel="stylesheet"><link rel="stylesheet" href="63e39972ccc0fe3bc036.css"/><script src="a03248bb48398d36ae0b.js"></script><script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script><link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/><style>.bg-menu-theme.menu-vertical .menu-item.active>.menu-link:not(.menu-toggle){background:#005396!important;box-shadow:0 2px 6px 0 rgba(42,30,179,.48);color:#fff!important}.tab-cont{display:none;background:#ededed;padding:15px}.tab-content.curr{display:inherit}.card>img{display:block;width:100%;max-width:500px;aspect-ratio:4/3;object-fit:cover;object-position:50% 50%;border-radius:16px 16px 0 0;filter:contrast(70%);transition:all .6s cubic-bezier(.43, .41, .22, .91)}.card>img:hover{filter:contrast(100%)}.card-content{display:flex;flex-direction:column;padding:20px 15px 20px}.card-content>p{margin-bottom:10px}.card-content>p:nth-child(1){font-size:1rem;font-weight:600;margin-bottom:10px;color:#1e40af}.wizard-card .icon-circle{font-size:30px;text-align:center}.wizard-card .icon-circle i{margin-top:15px}.nav-pills>li>a>i{color:#fff}.wizard-card .icon-circle i::after{color:#fff}.nav-pills>li>a>div>i ::after{color:#fff}.hide{display:none!important}.jstree-default{margin-left:100px}</style><script defer="defer" src="polyfill.js"></script><script defer="defer" src="uploads.js"></script></head><body><div class="layout-wrapper layout-content-navbar"><div class="layout-container"><aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme"><div class="app-brand demo"><a href="index.html" class="app-brand-link"><span class="app-brand-logo demo"><img src="assets/aaro-logo-80.png" alt width="40px" height="20px"> </span><span class="app-brand-text demo menu-text fw-bold">AARO SYSTEMS</span></a></div><ul class="menu-inner py-1"><li class="menu-item"><a href="index.html" class="menu-link"><i class="menu-icon fas fa-home"></i><div data-i18n="Dashboards">Templates</div></a></li><li class="menu-item"><a href="templates.html" class="menu-link"><i class="menu-icon fas fa-file-alt"></i><div data-i18n="Layouts">Reports</div></a></li><li class="menu-item active"><a href="uploads.html" class="menu-link"><i class="menu-icon fas fa-file-upload"></i><div data-i18n="Layouts">V1</div></a></li></ul></aside><div class="layout-page"><nav class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme" id="layout-navbar"><div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none"><a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)"><i class="fas fa-bars"></i></a></div><div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse"><ul class="navbar-nav flex-row align-items-center ms-auto"><li class="nav-item navbar-dropdown dropdown-user dropdown"><a class="nav-link dropdown-toggle hide-arrow" href="javascript:void(0);" data-bs-toggle="dropdown"><div class="avatar avatar-online"><img src="assets/card-advance-sale.png" alt class="h-auto rounded-circle"/></div></a><ul class="dropdown-menu dropdown-menu-end"><li><a class="dropdown-item" href="pages-account-settings-account.html"><div class="d-flex"><div class="flex-shrink-0 me-3"><div class="avatar avatar-online"><img src="assets/1.png" alt class="h-auto rounded-circle"/></div></div><div class="flex-grow-1"><span class="fw-semibold d-block" id="username"></span> <small class="text-muted">Admin</small></div></div></a></li><li><div class="dropdown-divider"></div></li><li><a class="dropdown-item" href="pages-profile-user.html"><i class="fas fa-user-check"></i> <span class="align-middle">My Profile</span></a></li><li><a class="dropdown-item" href="pages-account-settings-account.html"><i class="fas fa-cog"></i> <span class="align-middle">Settings</span></a></li><div class="dropdown-divider"></div></ul></li><li><a class="dropdown-item" href="pages-help-center-landing.html"><i class="fas fa-life-ring"></i> <span class="align-middle">Help</span></a></li><li><a class="dropdown-item" href="pages-faq.html"><i class="fas fa-circle-question"></i> <span class="align-middle">FAQ</span></a></li><li><div class="dropdown-divider"></div></li><li><a class="dropdown-item" id="logoutButton"><i class="fas fa-right-from-bracket"></i> <span class="align-middle">Log Out</span></a></li></ul></div><div class="navbar-search-wrapper search-input-wrapper d-none"><input class="form-control search-input container-xxl border-0" placeholder="Search..." aria-label="Search..."/> <i class="ti ti-x ti-sm search-toggler cursor-pointer"></i></div></nav><div class="content-wrapper"><div class="container-xxl flex-grow-1 container-p-y"><div class="row"><div class="col-md-12 col-12"><div class="card"><div class="card-header"><h5>Reports</h5></div><div class="card-body"><div class="wizard-container"><div class="card wizard-card" data-color="red" id="wizard"><div class="wizard-header"><h3 class="wizard-title">Welcome to AARO WORD CONNCECTOR</h3><p class="category">This information will let us know more about .</p></div><div class="wizard-navigation"><div class="progress-with-circle"><div class="progress-bar" role="progressbar" aria-valuenow="1" aria-valuemin="1" aria-valuemax="4" style="width:15%"></div></div><ul><li><a href="#start" data-toggle="tab"><div class="icon-circle"><i class="fa fa-arrow-right"></i></div>Start</a></li><li><a href="#report" data-toggle="tab"><div class="icon-circle"><i class="fa fa-file-alt"></i></div>Report</a></li><li><a href="#format" data-toggle="tab"><div class="icon-circle"><i class="fa fa-align-center"></i></div>Format</a></li><li><a href="#finish" data-toggle="tab"><div class="icon-circle"><i class="fa fa-unlink"></i></div>Finish</a></li></ul></div><div class="tab-content"><div class="tab-pane" id="start"><div class="row"><div class="col-sm-12"><h5 class="info-text">Kindly select the report you want to load on your Word Reporter</h5></div><div><h4>History</h4><table class="table"><thead><tr><th>id</th><th>Report</th><th>DateTime</th><th>Actions</th></tr></thead><tbody class="table-border-bottom-0"><tr><td><i class="ti ti-brand-angular ti-lg text-danger me-3"></i> <strong>1</strong></td><td>3 Income statement by Business Area</td><td><span class="badge bg-label-primary me-1">01/012023 12:25:36</span></td><td><div class="dropdown"><button type="button" class="btn p-0 dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="ti ti-dots-vertical"></i> Load</button></div></td></tr><tr><td><i class="ti ti-brand-react-native ti-lg text-info me-3"></i> <strong>2</strong></td><td>5 Consolidated balance sheet</td><td><span class="badge bg-label-primary me-1">01/012023 12:25:40</span></td><td><div class="dropdown"><button type="button" class="btn p-0 dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="ti ti-dots-vertical"></i>Load</button></div></td></tr></tbody></table></div></div></div><div class="tab-pane" id="report"><div id="jstree-ajax"></div></div><div class="tab-pane" id="format"><h5 class="info-text">Please Select the format to load the report.</h5><div class="row"><div class="col-sm-6 mb-3"><label for="decimal" class="form-label">Report Name</label> <input class="form-control" id="reportName" placeholder="Report Name" readonly="readonly" aria-describedby="defaultFormControlHelp" required/></div><div class="col-sm-6 mb-3"><label for="select2Icons" class="form-label">Table Styles</label> <select id="select2Icons" class="select2-icons form-select"></select></div><div class="col-sm-6 mb-3"><label for="decimal" class="form-label">Number of Decimal Places</label> <input class="form-control" id="decimalPlace" placeholder="2" aria-describedby="defaultFormControlHelp" required/></div></div></div><div class="tab-pane" id="finish"><form action="" method="Post"><div class="row"><div class="col-md mb-3"><label for="decimal" class="form-label">Report Name</label> <input class="form-control" id="reportN" placeholder="Report Name" readonly="readonly" aria-describedby="defaultFormControlHelp" required/></div><div class="col-md mb-3"><label for="decimal" class="form-label">Report ID</label> <input class="form-control" id="reportID" placeholder="Report Name" readonly="readonly" aria-describedby="defaultFormControlHelp" required/></div><div class="col-md mb-3"><label for="decimal" class="form-label">Table Styles</label> <input class="form-control" id="style" placeholder="Table Styles" readonly="readonly" aria-describedby="defaultFormControlHelp" required/></div><div class="col-md mb-3"><label for="decimal" class="form-label">Number of Decimal Places</label> <input class="form-control" id="decimal" placeholder="Number of Decimal Places" readonly="readonly" aria-describedby="defaultFormControlHelp" required/></div></div></form><div class="row" id="dataAppend"></div></div></div><div class="wizard-footer"><div class="pull-right"><input type="button" class="btn btn-next btn-fill btn-danger btn-wd" name="next" value="Next"/> <input type="button" class="btn btn-finish btn-fill btn-danger btn-wd hide" name="finish" value="Load Report"/></div><div class="pull-left"><input type="button" class="btn btn-previous btn-default btn-wd" name="previous" value="Previous"/></div><div class="clearfix"></div></div></div></div></div></div></div></div></div></div><footer class="content-footer footer bg-footer-theme"><div class="container-xxl"><div class="footer-container d-flex align-items-center justify-content-between py-2 flex-md-row flex-column"><div>Â©<script>document.write((new Date).getFullYear())</script>, <a href="https://www.aaro.com" target="_blank" class="fw-semibold">AARO SYSTEMS</a></div></div></div></footer><div class="content-backdrop fade"></div></div></div></div><div class="layout-overlay layout-menu-toggle"></div><div class="drag-target"></div><script src="a9c4045a35f65e7e6175.js"></script><script src="beb591c52f98e157c362.js"></script><script src="4876768a441b4bd048d3.js"></script><script src="50926170d3467b5fed73.js"></script><script src="991873c3de4f0ddbe968.js"></script><script src="d2b52d5f8d40708b7727.js"></script><script src="da902d10b05732de0fb7.js"></script><script src="888b5a97086a3b8ad569.js"></script><script src="a7fda6fb4268462a404e.js"></script><script src="a7c099bf3c7eec1a68ea.js"></script><script src="63e39972ccc0fe3bc036.css"></script><script src="ce9a80b0d84acd86ad63.js"></script><script src="d62f3bc7d8395216992d.js"></script><script src="39d4430f9cb852c0150e.js"></script><script>$(document).ready((function(){$('a[data-toggle="tab"]').on("shown.bs.tab",(function(e){"finish"===$(".tab-pane.active").attr("id")?$(".btn-finish").removeClass("hide"):$(".btn-finish").addClass("hide"),"start"===$(".tab-pane.active").attr("id")?$(".btn-previous").addClass("hide").css("btn-previous","display: none !important;"):$(".btn-previous").removeClass("hide")}));const e=localStorage.getItem("node_selected");JSON.parse(e);if(e){const t=JSON.parse(e);$("#reportName").val(t.text)}$("#ClearReport").click((function(){localStorage.clear(),location.reload()}))}));var theme=$("html").hasClass("light-style")?"default":"default-dark",ajaxTree=$("#jstree-ajax");async function loadJSTreeData(){try{var e=localStorage.getItem("aaroWebToken");console.log(e),await browseWithToken(e)}catch(e){console.error(e)}}function results(e,t){const a=`https://aaro-web.test/api/v1/reports/report/${e}`;let o=parseInt(e,10);if("number"==typeof o&&Number.isInteger(o)){let e=[o];localStorage.setItem("all_reports",JSON.stringify(e)),console.log(typeof o),console.log(a),fetch(a,{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${t}`}}).then((e=>e.json())).then((e=>{console.log("Data from other API:",e),localStorage.setItem("apiData",JSON.stringify(e));var t=localStorage.getItem("jstree");localStorage.setItem("jstree_temp",t),localStorage.setItem("criteria",JSON.stringify(e.criteria)),localStorage.removeItem("jstree")})).catch((e=>{console.error("Other API request failed:",e)}))}else console.log(Number.isInteger(o)),console.log(a)}function stringifySafe(e,t=5){const a=new WeakSet;return JSON.stringify(e,((e,o)=>{if("object"==typeof o&&null!==o){if(a.has(o)||0===t)return"[Circular]";a.add(o)}return o}))}async function login(){const e=await fetch("https://aaro-web.test/api/v1/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"doyle.abagail@example.net",password:"!admin123!"})});if(e.ok){const t=await e.json(),a=t.token;return console.log(t),console.log(t),localStorage.setItem("aaroWebToken",a),a}throw new Error("Login failed")}async function browseWithToken(e){const t=await fetch("https://aaro-web.test/api/v1/reports/browse",{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${e}`}});if(t.ok){const e=await t.json();console.log("this is harry "+stringifySafe(e))}else console.error("API request failed")}async function getDimensions(e){var t=localStorage.getItem("aaroWebToken");const a="https://aaro-web.test/api/v1/reports/report/dimensions/"+e,o=await fetch(a,{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${t}`}});if(o.ok){return await o.json()}console.error("API request failed")}async function createCheckboxes(e){const t=document.createElement("div");t.className="row";for(const a of e){const e=document.createElement("div");e.className="col-sm-6";const o=document.createElement("div");o.className="form-group";const n=document.createElement("label");n.className="form-label",n.appendChild(document.createTextNode(a.dimension));const r=document.createElement("select");r.className="form-select",r.name=a.dimension,r.id=`${a.dimension}-select`;const s=document.createElement("option");s.disabled=!0,s.selected=!0,s.appendChild(document.createTextNode(`- ${a.dimension} -`)),r.appendChild(s),o.appendChild(n),o.appendChild(r),e.appendChild(o),t.appendChild(e),console.log("dimension is"+a.dimension);const l=await getDimensions(a.dimension);l&&l.members&&Array.isArray(l.members)?l.members.forEach((e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,e.name===a.value&&(t.selected=!0),r.appendChild(t)})):console.error("Dimension members data is not an array:",l)}return t}async function main(){const e=document.querySelector("#format"),t=localStorage.getItem("criteria"),a=JSON.parse(t);if(console.log("criteria",a),a){const t=await createCheckboxes(a);e.appendChild(t)}}async function fetchTableStyles(){var e=localStorage.getItem("aaroWebToken");try{const t="https://aaro-web.test/api/v1/reports/table_styles",a=await $.ajax({url:t,type:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${e}`},dataType:"json"});return console.log(a),a}catch(e){throw console.error("Error fetching table styles:",e),e}}(async()=>{try{var e=localStorage.getItem("aaroWebToken");console.log(e),await browseWithToken(e),e||(e=await login(),localStorage.setItem("aaroWebToken",e)),ajaxTree.on("select_node.jstree",(function(t,a){const o=a.node;console.log("Node selected:",o),localStorage.setItem("node_selected",JSON.stringify(o)),results(o.id,e)})).jstree({core:{themes:{name:theme},check_callback:!0,data:{url:"https://aaro-web.test/api/v1/reports/browse",method:"POST",dataType:"json",data:function(t){return{id:t.id,name:t.name,parents:t.parents,parent:t.parent,_token:e}},headers:{Accept:"application/json",Authorization:`Bearer ${e}`}}},plugins:["types","state"],types:{default:{icon:"ti ti-folder"},html:{icon:"ti ti-brand-html5 text-danger"},css:{icon:"ti ti-brand-css3 text-info"},img:{icon:"ti ti-photo text-success"},js:{icon:"ti ti-brand-javascript text-warning"}}})}catch(e){console.error(e)}})(),main(),window.addEventListener("load",(async()=>{loadJSTreeData();const e=document.getElementById("select2Icons");try{const t=await fetchTableStyles();console.log("Response:",t);const a=Object.entries(t).map((([e,t])=>({slug:e,name:t}))),o={"Table Grid":[],"Plain Table":[],"Grid Table 1 Light":[],"Grid Table 2":[],"Grid Table 3":[],"Grid Table 4":[],"Grid Table 5 Dark":[],"Grid Table 6 Colorful":[],"Grid Table 7 Colorful":[]};a.forEach((e=>{e.name.startsWith("Table Grid")?o["Table Grid"].push(e):e.name.startsWith("Plain Table")?o["Plain Table"].push(e):e.name.startsWith("Grid Table 1 Light")?o["Grid Table 1 Light"].push(e):e.name.startsWith("Grid Table 2")?o["Grid Table 2"].push(e):e.name.startsWith("Grid Table 3")?o["Grid Table 3"].push(e):e.name.startsWith("Grid Table 4")?o["Grid Table 4"].push(e):e.name.startsWith("Grid Table 5 Dark")?o["Grid Table 5 Dark"].push(e):e.name.startsWith("Grid Table 6 Colorful")?o["Grid Table 6 Colorful"].push(e):e.name.startsWith("Grid Table 7 Colorful")&&o["Grid Table 7 Colorful"].push(e)}));for(const t in o){const a=document.createElement("optgroup");a.label=t,o[t].forEach((e=>{const t=document.createElement("option");t.value=e.slug,t.textContent=e.name,a.appendChild(t)})),e.appendChild(a)}}catch(e){console.error("Error loading table styles:",e)}})),$('a[data-toggle="tab"]').on("shown.bs.tab",(function(e){if("#finish"===$(e.target).attr("href")){const e=[],t=JSON.parse(localStorage.getItem("criteria")),a=document.querySelector("#finish");console.log(t);for(const o of t){const t=document.createElement("div");t.className="form-group";const n=document.createElement("label");n.appendChild(document.createTextNode(o.dimension));const r=document.createElement("input");r.type="text",r.className="form-control",r.value=o.value,r.readOnly=!0,r.id=`${o.dimension}-txt`,t.appendChild(n),t.appendChild(r),a.appendChild(t),e.push({dimension:o.dimension,value:o.value})}const o=localStorage.getItem("node_selected"),n=JSON.parse(o),r=n.text,s=n.id;console.log("Report Name:",r);const l=document.querySelector("#select2Icons").value,i=document.querySelector("#decimalPlace").value;$("#reportN").val(r),$("#reportID").val(s),$("#style").val(l),$("#decimal").val(i),console.log("Selected Criteria:",e)}})),$('a[data-toggle="tab"]').on("shown.bs.tab",(function(e){if("#format"===$(e.target).attr("href")){const e=localStorage.getItem("node_selected"),t=JSON.parse(e).text;console.log("Report Name:",t),$("#reportName").val(t)}}))</script></body></html>