<!doctype html><html lang="en" class="light-style layout-menu-fixed" dir="ltr" data-theme="theme-default" data-assets-path="./../../assets/" data-template="horizontal-menu-template-starter"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,minimum-scale=1,maximum-scale=1"/><title>AARO Dashboard</title><meta name="description" content=""/><script>sessionStorage.getItem("isLoggedIn")||(window.location.href="taskpane.html")</script><link rel="icon" type="image/x-icon" href="assets/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/><link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"><link rel="stylesheet" href="7f96fb030c3b8da277af.css"/><link rel="stylesheet" href="6c6375d92a7a8e50d101.css"/><link rel="stylesheet" href="d09b291222150a296b0e.css"/><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"><link rel="stylesheet" href="fb4fccff861a689f54d3.css"/><link rel="stylesheet" href="7c16e57d2292b7ebf778.css"/><link rel="stylesheet" href="fe2c97d35e55db959d4c.css"/><script src="a03248bb48398d36ae0b.js"></script><!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section --><script src="99a1c37098b9da83418b.js"></script><script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script><script src="7da6da571d54602f63fb.js"></script><script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script><link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/><style>.bg-menu-theme.menu-vertical .menu-item.active>.menu-link:not(.menu-toggle){background:#005396!important;box-shadow:0 2px 6px 0 rgba(42,30,179,.48);color:#fff!important}.form-check{padding-left:1em}.form-check-inline{margin-right:1.5rem}</style><script defer="defer" src="polyfill.js"></script><script defer="defer" src="index.js"></script></head><body><div class="layout-wrapper layout-content-navbar"><div class="layout-container"><aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme"><div class="app-brand demo"><a href="index.html" class="app-brand-link"><span class="app-brand-logo demo"><img src="assets/aaro-logo-80.png" alt="" width="40px" height="20px"> </span><span class="app-brand-text demo menu-text fw-bold">AARO SYSTEMS</span></a></div><ul class="menu-inner py-1"><li class="menu-item active"><a href="index.html" class="menu-link"><i class="menu-icon fas fa-home"></i><div data-i18n="Dashboards">Templates</div></a></li><li class="menu-item"><a href="templates.html" class="menu-link"><i class="menu-icon fas fa-file-alt"></i><div data-i18n="Layouts">Reports</div></a></li><li class="menu-item"><a href="uploads.html" class="menu-link"><i class="menu-icon fas fa-file-upload"></i><div data-i18n="Layouts">Upload</div></a></li></ul></aside><div class="layout-page"><nav class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme" id="layout-navbar"><div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none"><a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)"><i class="fas fa-bars"></i></a></div><div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse"><ul class="navbar-nav flex-row align-items-center ms-auto"><li class="nav-item navbar-dropdown dropdown-user dropdown"><a class="nav-link dropdown-toggle hide-arrow" href="javascript:void(0);" data-bs-toggle="dropdown"><div class="avatar avatar-online"><img src="assets/card-advance-sale.png" alt class="h-auto rounded-circle"/></div></a><ul class="dropdown-menu dropdown-menu-end"><li><a class="dropdown-item" href="pages-account-settings-account.html"><div class="d-flex"><div class="flex-shrink-0 me-3"><div class="avatar avatar-online"><img src="assets/1.png" alt class="h-auto rounded-circle"/></div></div><div class="flex-grow-1"><span class="fw-semibold d-block" id="username"></span> <small class="text-muted">Admin</small></div></div></a></li><li><div class="dropdown-divider"></div></li><li><a class="dropdown-item" href="pages-profile-user.html"><i class="fas fa-user-check"></i> <span class="align-middle">My Profile</span></a></li><li><a class="dropdown-item" href="pages-account-settings-account.html"><i class="fas fa-cog"></i> <span class="align-middle">Settings</span></a></li><div class="dropdown-divider"></div></ul></li><li><a class="dropdown-item" href="pages-help-center-landing.html"><i class="fas fa-life-ring"></i> <span class="align-middle">Help</span></a></li><li><a class="dropdown-item" href="pages-faq.html"><i class="fas fa-circle-question"></i> <span class="align-middle">FAQ</span></a></li><li><div class="dropdown-divider"></div></li><li><a class="dropdown-item" id="logoutButton"><i class="fas fa-right-from-bracket"></i> <span class="align-middle">Log Out</span></a></li></ul></div><div class="navbar-search-wrapper search-input-wrapper d-none"><input class="form-control search-input container-xxl border-0" placeholder="Search..." aria-label="Search..."/> <i class="ti ti-x ti-sm search-toggler cursor-pointer"></i></div></nav><div class="content-wrapper"><div class="container-xxl flex-grow-1 container-p-y"><div class="row"><div class="col-xl-4 mb-4 col-lg-5 col-12"><div class="card"><div class="d-flex align-items-end row"><div class="col-12"><div class="card-body text-nowrap"><h5 class="card-title mb-0">Generate Report</h5><br><div class="col-md mb-3"><label for="decimal" class="form-label">Report</label> <input class="form-control" id="reportName" placeholder="Report Name" readonly="readonly" aria-describedby="defaultFormControlHelp" required/></div><div class="col-md mb-3"><label for="select2Icons" class="form-label">Table Styles</label> <select id="select2Icons" class="select2-icons form-select"></select></div><div class="col-md mb-3"><label class="form-label">Parameters</label><br><div id="checkboxContainer" class="form-check form-check-inline"></div></div><div class="col-md mb-3 hidden"><label class="form-label" id="selectCreiteria"></label><div id="DimensionsDropdown"></div></div><div class="col-md mb-3"><label for="decimal" class="form-label">Number of Decimal Places</label> <input class="form-control" id="decimalPlace" placeholder="2" aria-describedby="defaultFormControlHelp" required/></div><div class="mb-3"><button id="submitReport" class="btn btn-primary"><i class="fa fa-tasks" aria-hidden="true">Load</i></button> <button id="refreshReportModal" class="btn btn-primary" data-toggle="modal" data-target="#myModal"><i class="fa fa-retweet" aria-hidden="true" onclick="populateModal()"></i> Refresh</button> <button id="TestReport" class="btn btn-primary"><i class="fa fa-tasks" aria-hidden="true">Test</i></button> <button id="refreshReport" class="btn btn-primary"><i class="fa fa-tasks" aria-hidden="true">refresh selected</i></button> <button id="refreshAll" class="btn btn-primary"><i class="fa fa-retweet" aria-hidden="true"></i> Refresh All</button><script>async function populateModal(){removeDropdown1();const e=localStorage.getItem("reportOrders");console.log("reports in order"),console.log(e),console.log(e.length);const n=localStorage.getItem("apiData");const o=JSON.parse(n).staticAxis.criteria;console.log(o);const t=document.getElementById("checkboxContainer2");document.getElementById("DimensionsDropdown2");t.classList.remove("hidden");new Set;const c=new Map;for(const e of o){const n=document.createElement("input");n.type="checkbox",n.className="form-check-input",n.name="rowAlignment",n.id=`rowAlignment${e.dimension}`,n.value=e.dimension;const o=document.createElement("label");o.className="form-check-label",o.htmlFor=`rowAlignment${e.dimension}`,o.appendChild(document.createTextNode(e.dimension));const i=document.createElement("div");i.className="form-check form-check-inline",i.appendChild(n),i.appendChild(o),console.log("here"),t.appendChild(i),n.addEventListener("change",(async()=>{n.checked?c.has(e.dimension)||await createDropdown(e.dimension):c.has(e.dimension)&&(console.log("hi joe"),removeDropdown(e.dimension))}))}t.appendChild(e)}async function createDropdown(e){const n=document.createElement("select");n.className="select2-icons form-select mb-3",n.dataset.dimension=e;document.getElementById("DimensionsDropdown2").appendChild(n);const o=await getDimensions(e),t=JSON.parse(JSON.stringify(o));for(const e of t.members){const o=document.createElement("option");o.value=e.name,o.textContent=e.name,n.appendChild(o)}dropdownMap.set(e,n)}async function removeDropdown(e){document.getElementById("checkboxContainer2").remove().replaceChild("checkboxContainer")}function removeDropdown1(){let e=document.getElementById("checkboxContainer2");for(;e.firstChild;)e.removeChild(e.firstChild)}document.getElementById("refreshReportModal").addEventListener("click",populateModal)</script><br><br><br><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="padding-top:120px;width:700px"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="exampleModalLabel">Refresh Parameters</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><div class="col-md mb-3"><label class="form-label">Select Parameters You Would Like To Change.<br>If you do not want To Change Click Submit Below<br></label><br></div><div id="checkboxContainer2" class="form-check form-check-inline"></div><div class="col-md mb-3 hidden"><label class="form-label" id="selectCreiteria"></label><div id="DimensionsDropdown2"></div></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button> <button id="refreshReport11" type="button" class="btn btn-primary">Refresh</button></div></div></div></div></div><script>function getSpecificOutput(e){return"noteThree"===e?(console.log("noteThree"),"noteThree"):"noteEight"===e?(console.log("noteEight"),"noteEight"):"noteFive"===e?(console.log("noteFive"),"noteFive"):"Default output"}</script></div></div></div></div></div></div></div><footer class="content-footer footer bg-footer-theme"><div class="container-xxl"><div class="footer-container d-flex align-items-center justify-content-between py-2 flex-md-row flex-column"><div>©<script>document.write((new Date).getFullYear())</script>, <a href="https://www.aaro.com" target="_blank" class="fw-semibold">AARO SYSTEMS</a></div></div></div></footer><div class="content-backdrop fade"></div></div></div></div><div class="layout-overlay layout-menu-toggle"></div><div class="drag-target"></div></div><script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script><script src="beb591c52f98e157c362.js"></script><script src="4876768a441b4bd048d3.js"></script><script src="e555446e70b12ddec22d.js"></script><script src="50926170d3467b5fed73.js"></script><script src="991873c3de4f0ddbe968.js"></script><script src="d2b52d5f8d40708b7727.js"></script><script src="da902d10b05732de0fb7.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/timer.jquery/0.9.0/timer.jquery.min.js"></script><script src="d5185b4b82bd36a3333a.js"></script><script>async function populateModal(){removeDropdown1();const e=localStorage.getItem("reportOrders");console.log("reports in order"),console.log(e),console.log(e.length);const n=localStorage.getItem("apiData");const t=JSON.parse(n).staticAxis.criteria;console.log(t);const o=document.getElementById("checkboxContainer2");document.getElementById("DimensionsDropdown2");o.classList.remove("hidden");new Set;const a=new Map;for(const e of t){const n=document.createElement("input");n.type="checkbox",n.className="form-check-input",n.name="rowAlignment",n.id=`rowAlignment${e.dimension}`,n.value=e.dimension;const t=document.createElement("label");t.className="form-check-label",t.htmlFor=`rowAlignment${e.dimension}`,t.appendChild(document.createTextNode(e.dimension));const r=document.createElement("div");r.className="form-check form-check-inline",r.appendChild(n),r.appendChild(t),console.log("here"),o.appendChild(r),n.addEventListener("change",(async()=>{n.checked?a.has(e.dimension)||await createDropdown(e.dimension):a.has(e.dimension)&&(console.log("hi joe"),removeDropdown(e.dimension))}))}o.appendChild(e)}async function createDropdown(e){const n=document.createElement("select");n.className="select2-icons form-select mb-3",n.dataset.dimension=e;document.getElementById("DimensionsDropdown2").appendChild(n);const t=await getDimensions(e),o=JSON.parse(JSON.stringify(t));for(const e of o.members){const t=document.createElement("option");t.value=e.name,t.textContent=e.name,n.appendChild(t)}dropdownMap.set(e,n)}async function removeDropdown(e){document.getElementById("checkboxContainer2").remove().replaceChild("checkboxContainer")}function removeDropdown1(){let e=document.getElementById("checkboxContainer2");for(;e.firstChild;)e.removeChild(e.firstChild)}function getSpecificOutput(e){return"noteThree"===e?(console.log("noteThree"),"noteThree"):"noteEight"===e?(console.log("noteEight"),"noteEight"):"noteFive"===e?(console.log("noteFive"),"noteFive"):"Default output"}async function createDropdown(e){const n=document.createElement("select");n.className="select2-icons form-select mb-3",n.dataset.dimension=e,dimensionsDropdown.appendChild(n);const t=await getDimensions(e),o=JSON.parse(JSON.stringify(t));for(const e of o.members){const t=document.createElement("option");t.value=e.name,t.textContent=e.name,n.appendChild(t)}dropdownMap.set(e,n)}function removeDropdown(e){const n=dropdownMap.get(e);n&&(n.remove(),dropdownMap.delete(e))}async function fetchTableStyles(){var e=localStorage.getItem("aaroWebToken");try{const n="https://aaro-web.test/api/v1/reports/table_styles",t=await $.ajax({url:n,type:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${e}`},dataType:"json"});return console.log(t),t}catch(e){throw console.error("Error fetching table styles:",e),e}}document.getElementById("refreshReportModal").addEventListener("click",populateModal),$(document).ready((function(){const e=localStorage.getItem("node_selected");JSON.parse(e);if(e){const n=JSON.parse(e);$("#reportName").val(n.text)}$("#ClearReport").click((function(){localStorage.clear(),location.reload()}));const n=localStorage.getItem("apiData");const t=JSON.parse(n).criteria;console.log(t);const o=document.getElementById("checkboxContainer"),a=(document.getElementById("DimensionsDropdown"),new Set,new Map);for(const e of t){const n=document.createElement("input");n.type="checkbox",n.className="form-check-input",n.name="rowAlignment",n.id=`rowAlignment${e.dimension}`,n.value=e.dimension;const t=document.createElement("label");t.className="form-check-label",t.htmlFor=`rowAlignment${e.dimension}`,t.appendChild(document.createTextNode(e.dimension));const r=document.createElement("div");r.className="form-check form-check-inline",r.appendChild(n),r.appendChild(t),o.appendChild(r),n.addEventListener("change",(async()=>{n.checked?a.has(e.dimension)||await createDropdown(e.dimension):a.has(e.dimension)&&removeDropdown(e.dimension)}))}})),window.addEventListener("load",(async()=>{const e=document.getElementById("select2Icons");try{const n=await fetchTableStyles();console.log("Response:",n);const t=Object.entries(n).map((([e,n])=>({slug:e,name:n}))),o={"Table Grid":[],"Plain Table":[],"Grid Table 1 Light":[],"Grid Table 2":[],"Grid Table 3":[],"Grid Table 4":[],"Grid Table 5 Dark":[],"Grid Table 6 Colorful":[],"Grid Table 7 Colorful":[]};t.forEach((e=>{e.name.startsWith("Table Grid")?o["Table Grid"].push(e):e.name.startsWith("Plain Table")?o["Plain Table"].push(e):e.name.startsWith("Grid Table 1 Light")?o["Grid Table 1 Light"].push(e):e.name.startsWith("Grid Table 2")?o["Grid Table 2"].push(e):e.name.startsWith("Grid Table 3")?o["Grid Table 3"].push(e):e.name.startsWith("Grid Table 4")?o["Grid Table 4"].push(e):e.name.startsWith("Grid Table 5 Dark")?o["Grid Table 5 Dark"].push(e):e.name.startsWith("Grid Table 6 Colorful")?o["Grid Table 6 Colorful"].push(e):e.name.startsWith("Grid Table 7 Colorful")&&o["Grid Table 7 Colorful"].push(e)}));for(const n in o){const t=document.createElement("optgroup");t.label=n,o[n].forEach((e=>{const n=document.createElement("option");n.value=e.slug,n.textContent=e.name,t.appendChild(n)})),e.appendChild(t)}}catch(e){console.error("Error loading table styles:",e)}}))</script></body></html>