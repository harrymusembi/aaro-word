<!DOCTYPE html>

<html lang="en" class="light-style layout-menu-fixed" dir="ltr" data-theme="theme-default"
  data-assets-path="./../../assets/" data-template="horizontal-menu-template-starter">

<head>
  <meta charset="utf-8" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

  <title>AARO Dashboard</title>

  <meta name="description" content="" />
  <script>
    // Check session login status
    if (!sessionStorage.getItem('isLoggedIn')) {
      // User is not logged in, redirect to login.html
      window.location.href = 'taskpane.html';
    }
  </script>
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="./../../assets/img/favicon/favicon.ico" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
    rel="stylesheet" type="text/css" />

  <!-- Icons -->
  <!-- <link rel="stylesheet" type="text/css" href="./../../assets/fontawesome.css" />
  <link rel="stylesheet" type="text/css" href="./../../assets/tabler-icons.css" />
  <link rel="stylesheet" type="text/css" href="./../../assets/flag-icons.css" /> -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

  <!-- Core CSS -->
  <link rel="stylesheet" type="text/css" href="./../../assets/vendor/css/rtl/core.css" />
  <link rel="stylesheet" type="text/css" href="./../../assets/vendor/css/rtl/theme-semi-dark.css" />
  <link rel="stylesheet" type="text/css" href="./../../assets/css/demo.css" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">


  <!-- Vendors CSS -->
  <link rel="stylesheet" type="text/css" href="./../../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />
  <link rel="stylesheet" type="text/css" href="./../../assets/vendor/libs/node-waves/node-waves.css" />

  <!-- Page CSS -->
  <link rel="stylesheet" href="./../../assets/vendor/libs/formvalidation/dist/css/formValidation.min.css" />
  <!-- Helpers -->
  <script src="./../../assets/vendor/js/helpers.js" type="text/javascript"></script>

  <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
  <!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
  <!-- <script src="./../../assets/vendor/js/template-customizer.js" type="text/javascript"></script> -->
  <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
  <script src="./../../assets/js/config.js" type="text/javascript"></script>

  <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js" type="text/javascript"></script>
  <script src="index.js" type="text/javascript"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <!-- <script src="templates.js" type="text/javascript"></script> -->
  <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
  <link rel="stylesheet" type="text/css"
    href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css" />
  <style>
    .bg-menu-theme.menu-vertical .menu-item.active>.menu-link:not(.menu-toggle) {
      background: #005396 !important;
      box-shadow: 0px 2px 6px 0px rgba(42, 30, 179, 0.48);
      color: #fff !important;
    }

    .form-check {
      padding-left: 1.0em;
    }

    .form-check-inline {

      margin-right: 1.5rem;
    }
  </style>
</head>

<body>
  <!-- Layout wrapper -->

  <div class="layout-wrapper layout-content-navbar">
    <div class="layout-container">
      <!-- Menu -->
      <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
        <div class="app-brand demo">
          <a href="index.html" class="app-brand-link">
            <span class="app-brand-logo demo">
              <img src="./../../assets/img/branding/aaro-logo-80.png" alt="" width="40px" height="20px">
            </span>
            <span class="app-brand-text demo menu-text fw-bold">AARO SYSTEMS</span>
          </a>
        </div>

        <!-- <div class="menu-inner-shadow"></div> -->

        <ul class="menu-inner py-1">
          <!-- Dashboards -->
          <li class="menu-item  active">
            <a href="index.html" class="menu-link">
              <i class="menu-icon fas fa-home"></i>
              <div data-i18n="Dashboards">Templates</div>
              <!-- <div class="badge bg-label-primary rounded-pill ms-auto">3</div> -->
            </a>
          </li>

          <!-- Layouts -->
          <li class="menu-item">
            <a href="templates.html" class="menu-link">
              <i class="menu-icon fas fa-file-alt"></i>
              <div data-i18n="Layouts">Reports</div>
            </a>

          </li>

          <li class="menu-item">
            <a href="uploads.html" class="menu-link">
              <i class="menu-icon fas fa-file-upload"></i>
              <div data-i18n="Layouts">Upload</div>
            </a>

          </li>


        </ul>
      </aside>
      <!-- / Menu -->

      <!-- Layout container -->
      <div class="layout-page">
        <!-- Navbar -->

        <nav
          class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme"
          id="layout-navbar">
          <div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none">
            <a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
              <i class="fas fa-bars"></i>
            </a>
          </div>

          <div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse">
            <!-- Search -->

            <!-- /Search -->

            <ul class="navbar-nav flex-row align-items-center ms-auto">




              <!-- User -->
              <li class="nav-item navbar-dropdown dropdown-user dropdown">
                <a class="nav-link dropdown-toggle hide-arrow" href="javascript:void(0);" data-bs-toggle="dropdown">
                  <div class="avatar avatar-online">
                    <img src="../../assets/img/illustrations/card-advance-sale.png" alt class="h-auto rounded-circle" />
                  </div>
                </a>
                <ul class="dropdown-menu dropdown-menu-end">
                  <li>
                    <a class="dropdown-item" href="pages-account-settings-account.html">
                      <div class="d-flex">
                        <div class="flex-shrink-0 me-3">
                          <div class="avatar avatar-online">
                            <img src="../../assets/img/avatars/1.png" alt class="h-auto rounded-circle" />
                          </div>
                        </div>
                        <div class="flex-grow-1">
                          <span class="fw-semibold d-block" id="username"></span>
                          <small class="text-muted">Admin</small>
                        </div>
                      </div>
                    </a>
                  </li>
                  <li>
                    <div class="dropdown-divider"></div>
                  </li>
                  <li>
                    <a class="dropdown-item" href="pages-profile-user.html">
                      <i class="fas fa-user-check"></i>
                      <span class="align-middle">My Profile</span>
                    </a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="pages-account-settings-account.html">
                      <i class="fas fa-cog"></i>
                      <span class="align-middle">Settings</span>
                    </a>
                  </li>

                  <div class="dropdown-divider"></div>
              </li>
              <li>
                <a class="dropdown-item" href="pages-help-center-landing.html">
                  <i class="fas fa-life-ring"></i>
                  <span class="align-middle">Help</span>
                </a>
              </li>
              <li>
                <a class="dropdown-item" href="pages-faq.html">
                  <i class="fas fa-circle-question"></i>
                  <span class="align-middle">FAQ</span>
                </a>
              </li>

              <li>
                <div class="dropdown-divider"></div>
              </li>
              <li>
                <a class="dropdown-item" id="logoutButton">
                  <i class="fas fa-right-from-bracket"></i>
                  <span class="align-middle">Log Out</span>
                </a>
              </li>
            </ul>
            </li>
            <!--/ User -->
            </ul>
          </div>

          <!-- Search Small Screens -->
          <div class="navbar-search-wrapper search-input-wrapper d-none">
            <input type="text" class="form-control search-input container-xxl border-0" placeholder="Search..."
              aria-label="Search..." />
            <i class="ti ti-x ti-sm search-toggler cursor-pointer"></i>
          </div>
        </nav>

        <!-- / Navbar -->

        <!-- Content wrapper -->
        <div class="content-wrapper">
          <!-- Content -->

          <div class="container-xxl flex-grow-1 container-p-y">
            <div class="row">
              <div class="col-xl-4 mb-4 col-lg-5 col-12">
                <div class="card">
                  <div class="d-flex align-items-end row">
                    <div class="col-12">
                      <div class="card-body text-nowrap">
                        <h5 class="card-title mb-0">Generate Report</h5>
                        <br>
                        <!-- <div class="col-md mb-3">
                          <label for="tableSelect" class="form-label">Select Table Template</label>
                          <select class="form-select" id="tableSelect" aria-label="Default select example" required>
                            <option selected="">Choose Your Table</option>
                            <option value="noteThree">Note 3 Other operating expense</option>
                            <option value="noteEight">Note 8 Intangible fixed assets</option>
                            <option value="noteFive">Note 5 Consolidated balance sheet</option>
                          </select>
                        </div> -->
                        <div class="col-md mb-3">
                          <label for="decimal" class="form-label">Report</label>
                          <input type="text" class="form-control" id="reportName" placeholder="Report Name" readonly
                            aria-describedby="defaultFormControlHelp" required />

                        </div>
                        <div class="col-md mb-3">
                          <label for="select2Icons" class="form-label">Table Styles</label>
                          <select id="select2Icons" class="select2-icons form-select"> </select>
                        </div>

                        <div class="col-md mb-3">
                          <label class="form-label">Parameters</label><br>
                          <div id="checkboxContainer" class="form-check form-check-inline">
                          </div>
                        </div>


                        <div class="col-md mb-3 hidden">
                          <label class="form-label" id="selectCreiteria"></label>
                          <!-- <select  class="select2-icons form-select">

                          </select> -->
                          <div id="DimensionsDropdown"></div>

                        </div>


                        <!-- <div class="col-md mb-3 hidden">
                          <small class="text-light fw-semibold d-block">First Column Alignment</small>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="columnAlignment" id="columnAlignmentleft"
                              value="left" checked/>
                            <label class="form-check-label" for="columnAlignmentleft">Left</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="columnAlignment"
                              id="columnAlignmentcenter" value="center" />
                            <label class="form-check-label" for="columnAlignmentcenter">Center</label>
                          </div>
                          <div class="form-check form-check-inline mt-3">
                            <input class="form-check-input" type="radio" name="columnAlignment"
                              id="columnAlignmentright" value="right" />
                            <label class="form-check-label" for="columnAlignmentright">Right</label>
                          </div>
                          
                        </div>
                        <div class="col-md mb-3 hidden">
                          <small class="text-light fw-semibold d-block">First Row Alignment</small>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="rowAlignment" id="rowAlignmentLeft"
                              value="left" checked/>
                            <label class="form-check-label" for="rowAlignmentLeft">Left</label>
                          </div>
                          
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="rowAlignment" id="rowAlignmentCenter"
                              value="center" />
                            <label class="form-check-label" for="rowAlignmentCenter">center</label>
                          </div>
                          <div class="form-check form-check-inline mt-3">
                            <input class="form-check-input" type="radio" name="rowAlignment" id="rowAlignmentRight"
                              value="right" />
                            <label class="form-check-label" for="rowAlignmentRight">right</label>
                          </div>
                          
                        </div> -->
                        <div class="col-md mb-3">
                          <label for="decimal" class="form-label">Number of Decimal Places</label>
                          <input type="text" class="form-control" id="decimalPlace" placeholder="2"
                            aria-describedby="defaultFormControlHelp" required />

                        </div>
                        <div class="mb-3">
                          <button id="submitReport" class="btn btn-primary"><i class="fa fa-tasks" aria-hidden="true">
                              Load</i></button>
<!-- Your button -->
<button id="refreshReportModal" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
  <i class="fa fa-retweet" aria-hidden="true" onclick="populateModal()"></i> Refresh</button>

  <script>

async function populateModal() {
  const apiData = localStorage.getItem('apiData');
let api_data = JSON.parse(apiData);
const dimensions = api_data.staticAxis.criteria

console.log(dimensions)

const container = document.getElementById('checkboxContainer2');
const dimensionsDropdown = document.getElementById('DimensionsDropdown2');
// container.classList.remove('hidden');
const selectedDimensions = new Set();
const dropdownMap = new Map();



for (const item of dimensions) {
  const checkbox = document.createElement('input');
  checkbox.type = 'checkbox';
  checkbox.className = 'form-check-input'; // Add the appropriate class
  checkbox.name = 'rowAlignment';
  checkbox.id = `rowAlignment${item.dimension}`; // Generate a unique ID for each checkbox
  checkbox.value = item.dimension;

  const label = document.createElement('label');
  label.className = 'form-check-label'; // Add the appropriate class
  label.htmlFor = `rowAlignment${item.dimension}`;
  label.appendChild(document.createTextNode(item.dimension));


  const div = document.createElement('div');
  div.className = 'form-check form-check-inline';
  div.appendChild(checkbox);
  div.appendChild(label);

  container.appendChild(div);

  checkbox.addEventListener('change', async () => {
    if (checkbox.checked) {
      if (!dropdownMap.has(item.dimension)) {
        await createDropdown(item.dimension);
      }
    } else {
      if (dropdownMap.has(item.dimension)) {
        removeDropdown(item.dimension);
      }
    }
  });

}
}

async function createDropdown(dimension) {
        const selectDropdown = document.createElement('select');
        selectDropdown.className = 'select2-icons form-select mb-3';
        selectDropdown.dataset.dimension = dimension; // Store the dimension as a dataset attribute
        const dimensionsDropdown = document.getElementById('DimensionsDropdown2');

        // Add the select dropdown to the 'dimensionsDropdown' div
        dimensionsDropdown.appendChild(selectDropdown);

        const DData = await getDimensions(dimension);
        const DimensionsData = JSON.parse(JSON.stringify(DData));

        for (const option of DimensionsData.members) {
          const dropdownOption = document.createElement('option');
          dropdownOption.value = option.name;
          dropdownOption.textContent = option.name;
          selectDropdown.appendChild(dropdownOption);
        }

        // Store the dropdown reference in the map
        dropdownMap.set(dimension, selectDropdown);
      }

      async function removeDropdown(dimension) {
        const selectDropdown = dropdownMap.get(dimension);
        if (selectDropdown) {
          selectDropdown.remove();
          dropdownMap.delete(dimension);
        }
      }

      document.getElementById("refreshReportModal").addEventListener("click", populateModal);

  </script>

<!-- Modal Structure --><br><br><br>
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="padding-top: 120px;">
<div class="modal-dialog" role="document">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="exampleModalLabel">Refresh Parameters</h5>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="col-md mb-3">
        <label class="form-label">Select Parameters You Would Like To Change. <br>If you do not want To Change Click Submit Below<br></label><br>
        <div id="checkboxContainer2" class="form-check form-check-inline">
        </div>
      </div>


      <div class="col-md mb-3 hidden">
        <label class="form-label" id="selectCreiteria"></label>
        <!-- <select  class="select2-icons form-select">

        </select> -->
        <div id="DimensionsDropdown2"></div>

      </div>    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      <button id="refreshReport" type="button" class="btn btn-primary">Save changes</button>
    </div>
  </div>
</div>
</div>
                                    
                          <button id="ClearReport" class="btn btn-primary"><i class="fa fa-times" aria-hidden="true">
                              Clear </i></button>
                        </div>

                        <!-- <script src="templates.js"></script> -->
                        <script>
                          function getSpecificOutput(value) {
                            if (value === 'noteThree') {
                              console.log("noteThree");
                              return 'noteThree';
                            } else if (value === 'noteEight') {
                              console.log("noteEight");
                              return 'noteEight';
                            } else if (value === 'noteFive') {
                              console.log("noteFive");
                              return 'noteFive';
                            } else {
                              return 'Default output';
                            }
                          }
                        </script>
                      </div>
                    </div>

                  </div>
                </div>
              </div>

            </div>



          </div>
          <!-- / Content -->

          <!-- Footer -->
          <footer class="content-footer footer bg-footer-theme">
            <div class="container-xxl">
              <div
                class="footer-container d-flex align-items-center justify-content-between py-2 flex-md-row flex-column">
                <div>
                  ©
                  <script>
                    document.write(new Date().getFullYear());
                  </script>
                  , <a href="https://www.aaro.com" target="_blank" class="fw-semibold">AARO
                    SYSTEMS</a>
                </div>

              </div>
            </div>
          </footer>
          <!-- / Footer -->

          <div class="content-backdrop fade"></div>
        </div>
        <!-- Content wrapper -->
      </div>
      <!-- / Layout page -->
    </div>

    <!-- Overlay -->
    <div class="layout-overlay layout-menu-toggle"></div>

    <!-- Drag Target Area To SlideIn Menu On Small Screens -->
    <div class="drag-target"></div>
  </div>

  <!--/ Layout wrapper -->
  <!-- <script>

    const form = document.getElementById('uploadForm');
    const fileInput = document.getElementById('bs-validation-upload-file');

    form.addEventListener('submit', (event) => {
    event.preventDefault();
    
    const file = fileInput.files[0];
    const reader = new FileReader();

    reader.addEventListener('load', () => {
        const data = JSON.parse(reader.result);
        const data = JSON.parse(reader.result);
    const translatedData = await translateClient.translate(data, '<target-language-code>');

    Office.context.document.setSelectedDataAsync(translatedData, {
      coercionType: Office.CoercionType.Text,
        console.log(data);
    });

    reader.readAsText(file);
    });

       

</script> -->
  <!-- Core JS -->
  <!-- build:js ./../../assets/vendor/js/core.js -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


  <script type="text/javascript" src="./../../assets/vendor/libs/jquery/jquery.js"></script>
  <script type="text/javascript" src="./../../assets/vendor/libs/popper/popper.js"></script>
  <script type="text/javascript" src="./../../assets/vendor/js/bootstrap.js"></script>
  <script type="text/javascript" src="./../../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>
  <script type="text/javascript" src="./../../assets/vendor/libs/node-waves/node-waves.js"></script>
  <script type="text/javascript" src="./../../assets/vendor/libs/hammer/hammer.js"></script>
  <script type="text/javascript" src="./../../assets/vendor/js/menu.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/timer.jquery/0.9.0/timer.jquery.min.js">
  </script>
  <!-- Include your app.js file -->
  <!-- <script src="app.js"></script> -->
  <!-- endbuild -->
  <!-- Vendors JS -->
  <!-- <script src="./../../assets/vendor/libs/formvalidation/dist/js/FormValidation.min.js"></script> -->
  <!-- <script src="./../../assets/vendor/libs/formvalidation/dist/js/plugins/Bootstrap5.min.js"></script>
    <script src="./../../assets/vendor/libs/formvalidation/dist/js/plugins/AutoFocus.min.js"></script> -->
  <!-- Main JS -->
  <script type="text/javascript" src="./../../assets/js/main.js"></script>
  <!-- Page JS -->
  <!-- <script type="text/javascript" src="./../../assets/js/form-validation.js"></script> -->
  <script>
    window.addEventListener("load", () => {
      const selectElement = document.getElementById("select2Icons");

      // Create an XMLHttpRequest object
      const xhr = new XMLHttpRequest();

      // Configure the request
      xhr.open("GET", "http://localhost:3000/table_styles", true);

      // Set the response type to JSON
      xhr.responseType = "json";

      // Define the callback function for the AJAX request
      xhr.onload = function () {
        if (xhr.status === 200) {
          const tableStyles = xhr.response;

          // Group the table styles
          const groupedOptions = {
            "Table Grid": [],
            "Plain Table": [],
            "Grid Table 1 Light": [],
            "Grid Table 2": [],
            "Grid Table 3": [],
            "Grid Table 4": [],
            "Grid Table 5 Dark": [],
            "Grid Table 6 Colorful": [],
            "Grid Table 7 Colorful": []
            // Add more groups as needed
          };

          tableStyles.forEach((style) => {
            if (style.name.startsWith("Table Grid")) {
              groupedOptions["Table Grid"].push(style);
            } else if (style.name.startsWith("Plain Table")) {
              groupedOptions["Plain Table"].push(style);
            } else if (style.name.startsWith("Grid Table 1 Light")) {
              groupedOptions["Grid Table 1 Light"].push(style);
            } else if (style.name.startsWith("Grid Table 2")) {
              groupedOptions["Grid Table 2"].push(style);
            } else if (style.name.startsWith("Grid Table 3")) {
              groupedOptions["Grid Table 3"].push(style);
            } else if (style.name.startsWith("Grid Table 4")) {
              groupedOptions["Grid Table 4"].push(style);
            } else if (style.name.startsWith("Grid Table 5 Dark")) {
              groupedOptions["Grid Table 5 Dark"].push(style);
            } else if (style.name.startsWith("Grid Table 6 Colorful")) {
              groupedOptions["Grid Table 6 Colorful"].push(style);
            } else if (style.name.startsWith("Grid Table 7 Colorful")) {
              groupedOptions["Grid Table 7 Colorful"].push(style);
            }
            // Add more conditions to group the table styles based on your desired logic
          });

          // Generate the select options dynamically
          for (const groupName in groupedOptions) {
            const group = document.createElement("optgroup");
            group.label = groupName;
            groupedOptions[groupName].forEach((optionValue) => {
              const option = document.createElement("option");
              option.value = optionValue.slug; // Use the 'slug' property as the option value
              option.textContent = optionValue.name; // Use the 'name' property as the option text
              group.appendChild(option);
            });
            selectElement.appendChild(group);
          }
        } else {
          console.error("Error loading table styles:", xhr.status);
        }
      };

      // Send the request
      xhr.send();
    });





    $(document).ready(function () {
      // Retrieve the stored JSON data from local storage
      const storedData = localStorage.getItem('node_selected');
      const data = JSON.parse(storedData);
      if (storedData) {
        const selectedNode = JSON.parse(storedData);

        // console.log( selectedNode);
        $('#reportName').val(selectedNode.text);
      }

      $("#ClearReport").click(function () {
        // Clear all items from local storage
        localStorage.clear();

        // Refresh the page
        location.reload();
      });

      

      const apiData = localStorage.getItem('apiData');
      let api_data = JSON.parse(apiData);
      const dimensions = api_data.staticAxis.criteria

      console.log(dimensions)

      const container = document.getElementById('checkboxContainer');
      const dimensionsDropdown = document.getElementById('DimensionsDropdown');
      // container.classList.remove('hidden');
      const selectedDimensions = new Set();
      const dropdownMap = new Map();


      for (const item of dimensions) {
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'form-check-input'; // Add the appropriate class
        checkbox.name = 'rowAlignment';
        checkbox.id = `rowAlignment${item.dimension}`; // Generate a unique ID for each checkbox
        checkbox.value = item.dimension;

        const label = document.createElement('label');
        label.className = 'form-check-label'; // Add the appropriate class
        label.htmlFor = `rowAlignment${item.dimension}`;
        label.appendChild(document.createTextNode(item.dimension));


        const div = document.createElement('div');
        div.className = 'form-check form-check-inline';
        div.appendChild(checkbox);
        div.appendChild(label);

        container.appendChild(div);

        checkbox.addEventListener('change', async () => {
          if (checkbox.checked) {
            if (!dropdownMap.has(item.dimension)) {
              await createDropdown(item.dimension);
            }
          } else {
            if (dropdownMap.has(item.dimension)) {
              removeDropdown(item.dimension);
            }
          }
        });

      }


      // function populateModal() {

      //   const apiData = localStorage.getItem('apiData');
      //   let api_data = JSON.parse(apiData);
      //   const dimensions = api_data.staticAxis.criteria

      //   console.log(dimensions)

      //   const container = document.getElementById('checkboxContainer2');
      //   const dimensionsDropdown2 = document.getElementById('DimensionsDropdown2');
      //   // container.classList.remove('hidden');
      //   const selectedDimensions = new Set();
      //   const dropdownMap = new Map();


      //   for (const item of dimensions) {
      //     const checkbox = document.createElement('input');
      //     checkbox.type = 'checkbox';
      //     checkbox.className = 'form-check-input'; // Add the appropriate class
      //     checkbox.name = 'rowAlignment';
      //     checkbox.id = `rowAlignment${item.dimension}`; // Generate a unique ID for each checkbox
      //     checkbox.value = item.dimension;

      //     const label = document.createElement('label');
      //     label.className = 'form-check-label'; // Add the appropriate class
      //     label.htmlFor = `rowAlignment${item.dimension}`;
      //     label.appendChild(document.createTextNode(item.dimension));


      //     const div = document.createElement('div');
      //     div.className = 'form-check form-check-inline';
      //     div.appendChild(checkbox);
      //     div.appendChild(label);

      //     container.appendChild(div);

      //     checkbox.addEventListener('change', async () => {
      //       if (checkbox.checked) {
      //         if (!dropdownMap.has(item.dimension)) {
      //           await createDropdown(item.dimension);
      //         }
      //       } else {
      //         if (dropdownMap.has(item.dimension)) {
      //           removeDropdown(item.dimension);
      //         }
      //       }
      //     });

      //   }
      // }
      async function createDropdown(dimension) {
        const selectDropdown = document.createElement('select');
        selectDropdown.className = 'select2-icons form-select mb-3';
        selectDropdown.dataset.dimension = dimension; // Store the dimension as a dataset attribute

        // Add the select dropdown to the 'dimensionsDropdown' div
        dimensionsDropdown.appendChild(selectDropdown);

        const DData = await getDimensions(dimension);
        const DimensionsData = JSON.parse(JSON.stringify(DData));

        for (const option of DimensionsData.members) {
          const dropdownOption = document.createElement('option');
          dropdownOption.value = option.name;
          dropdownOption.textContent = option.name;
          selectDropdown.appendChild(dropdownOption);
        }

        // Store the dropdown reference in the map
        dropdownMap.set(dimension, selectDropdown);
      }

      function removeDropdown(dimension) {
        const selectDropdown = dropdownMap.get(dimension);
        if (selectDropdown) {
          selectDropdown.remove();
          dropdownMap.delete(dimension);
        }
      }

    });
  </script>
</body>

</html>